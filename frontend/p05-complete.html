<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>數位轉型問卷系統 - 完成</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Google Material Icons -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="../assets/css/custom.css" rel="stylesheet">
</head>
<body>
  <div class="survey-container">
    <!-- 進度條 -->
    <div class="progress-steps">
      <div class="progress-step completed">
        <div class="progress-circle">✓</div>
        <div class="progress-label">基本資料</div>
      </div>
      <div class="progress-step completed">
        <div class="progress-circle">✓</div>
        <div class="progress-label">數位現況</div>
      </div>
      <div class="progress-step completed">
        <div class="progress-circle">✓</div>
        <div class="progress-label">轉型經驗</div>
      </div>
      <div class="progress-step active completed">
        <div class="progress-circle">✓</div>
        <div class="progress-label">完成</div>
      </div>
    </div>

    <!-- 完成卡片 -->
    <div class="card border-0 shadow-sm">
      <div class="card-body text-center py-5">
        <!-- 成功圖示 -->
        <div class="completion-icon"></div>

        <!-- 感謝訊息 -->
        <h2 class="mb-3" style="font-size: var(--font-title); font-weight: bold; color: var(--success-color);">
          問卷提交成功！
        </h2>

        <p class="text-muted mb-4" style="font-size: 16px;">
          感謝您撥冗填寫本問卷<br>
          您的寶貴意見將協助我們更了解中小企業的數位轉型需求
        </p>

        <!-- 資訊卡片 -->
        <div class="row mt-5 mb-4">
          <div class="col-md-4">
            <div class="stat-card">
              <div class="stat-number" id="surveyId">-</div>
              <div class="stat-label">問卷編號</div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="stat-card">
              <div class="stat-number" id="submitDate">-</div>
              <div class="stat-label">提交日期</div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="stat-card">
              <div class="stat-number" id="submitTime">-</div>
              <div class="stat-label">提交時間</div>
            </div>
          </div>
        </div>

        <!-- 提示訊息 -->
        <div class="alert alert-info text-start mt-4">
          <h6 class="mb-2"><strong>後續事項：</strong></h6>
          <ul class="mb-0" style="line-height: 1.8;">
            <li>如您勾選願意接受聯繫，相關單位將於 <strong>30 個工作天內</strong> 與您聯絡</li>
            <li>問卷結果將作為政策規劃參考，統計資料將公開於經濟部網站</li>
            <li>如有疑問，請洽詢專線：<strong>0800-000-000</strong></li>
            <li>或來信：<a href="mailto:digital@moea.gov.tw">digital@moea.gov.tw</a></li>
          </ul>
        </div>

        <!-- 按鈕組 -->
        <div class="d-grid gap-2 col-md-6 mx-auto mt-5">
          <button type="button" class="btn btn-primary" onclick="window.print()">
            列印問卷確認單
          </button>
          <button type="button" class="btn btn-outline-primary" onclick="window.location.href='p01-welcome.html'">
            返回首頁
          </button>
        </div>

        <!-- 頁尾 -->
        <p class="text-muted mt-5 mb-0">
          <small>
            主辦單位：經濟部中小企業處<br>
            執行單位：財團法人中小企業信用保證基金
          </small>
        </p>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    window.addEventListener('load', function() {
      // 檢查是否已提交
      const submitted = localStorage.getItem('surveySubmitted');
      if (!submitted) {
        window.location.href = 'p01-welcome.html';
        return;
      }

      // 生成問卷編號（模擬）
      const surveyId = 'DT' + new Date().getFullYear() + Math.random().toString(36).substring(2, 9).toUpperCase();
      document.getElementById('surveyId').textContent = surveyId;

      // 顯示提交日期時間
      const now = new Date();
      document.getElementById('submitDate').textContent = now.toLocaleDateString('zh-TW');
      document.getElementById('submitTime').textContent = now.toLocaleTimeString('zh-TW', { hour: '2-digit', minute: '2-digit' });

      // 儲存問卷編號
      localStorage.setItem('surveyId', surveyId);
    });

    // 防止返回
    history.pushState(null, null, location.href);
    window.onpopstate = function () {
      history.go(1);
    };
  </script>
</body>
</html>
